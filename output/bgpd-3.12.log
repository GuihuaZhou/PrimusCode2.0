2019/07/31 15:28:29 BGP: BGPd 1.2.4 starting: vty@2605, bgp@<all>:179 pid 1652
2019/07/31 15:28:30 BGP: 32.12.1.1 [FSM] Timer (start timer expire).
2019/07/31 15:28:30 BGP: 32.12.1.1 [FSM] BGP_Start (Idle->Connect)
2019/07/31 15:28:30 BGP: 32.12.1.1 [Event] Connect start to 32.12.1.1 fd 16
2019/07/31 15:28:30 BGP: 32.12.1.1 [FSM] Non blocking connect waiting result
2019/07/31 15:28:30 BGP: 32.12.1.1 went from Idle to Connect
2019/07/31 15:28:30 BGP: 32.12.1.1 [FSM] TCP_connection_open (Connect->OpenSent)
2019/07/31 15:28:30 BGP: 32.12.1.1 open active, local address 32.12.1.0
2019/07/31 15:28:30 BGP: 32.12.1.1 sending OPEN, version 4, my as 65001, holdtime 180, id 30.0.0.12
2019/07/31 15:28:30 BGP: 32.12.1.1 send message type 1, length (incl. header) 59
2019/07/31 15:28:30 BGP: 32.12.1.1 went from Connect to OpenSent
2019/07/31 15:28:30 BGP: stream_read_try: read failed on fd 16: Connection reset by peer
2019/07/31 15:28:30 BGP: 32.12.1.1 [Error] bgp_read_packet error: Connection reset by peer
2019/07/31 15:28:30 BGP: 32.12.1.1 [FSM] TCP_fatal_error (OpenSent->Active)
2019/07/31 15:28:30 BGP: 32.12.1.1 went from OpenSent to Active
2019/07/31 15:28:30 BGP: [Event] BGP connection from host 32.12.2.1:49372
2019/07/31 15:28:30 BGP: [Event] BGP connection IP address 32.12.2.1 is Idle state
2019/07/31 15:28:31 BGP: 32.12.2.1 [FSM] Timer (start timer expire).
2019/07/31 15:28:31 BGP: 32.12.2.1 [FSM] BGP_Start (Idle->Connect)
2019/07/31 15:28:31 BGP: 32.12.2.1 [Event] Connect start to 32.12.2.1 fd 20
2019/07/31 15:28:31 BGP: 32.12.2.1 [FSM] Non blocking connect waiting result
2019/07/31 15:28:31 BGP: 32.12.2.1 went from Idle to Connect
2019/07/31 15:28:31 BGP: 32.12.2.1 [FSM] TCP_connection_open (Connect->OpenSent)
2019/07/31 15:28:31 BGP: 32.12.2.1 open active, local address 32.12.2.0
2019/07/31 15:28:31 BGP: 32.12.2.1 sending OPEN, version 4, my as 65001, holdtime 180, id 30.0.0.12
2019/07/31 15:28:31 BGP: 32.12.2.1 send message type 1, length (incl. header) 59
2019/07/31 15:28:31 BGP: 32.12.2.1 went from Connect to OpenSent
2019/07/31 15:28:31 BGP: 32.12.2.1 rcv message type 1, length (excl. header) 40
2019/07/31 15:28:31 BGP: 32.12.2.1 rcv OPEN, version 4, remote-as (in open) 65002, holdtime 180, id 20.0.0.7, outbound connection
2019/07/31 15:28:31 BGP: 32.12.2.1 rcv OPEN w/ OPTION parameter len: 30
2019/07/31 15:28:31 BGP: 32.12.2.1 rcvd OPEN w/ optional parameter type 2 (Capability) len 6
2019/07/31 15:28:31 BGP: 32.12.2.1 OPEN has MultiProtocol Extensions capability (1), length 4
2019/07/31 15:28:31 BGP: 32.12.2.1 OPEN has MP_EXT CAP for afi/safi: 1/1
2019/07/31 15:28:31 BGP: 32.12.2.1 rcvd OPEN w/ optional parameter type 2 (Capability) len 2
2019/07/31 15:28:31 BGP: message index 128 [Route Refresh (Old)] found in capcode_str at position 6 (max is 8)
2019/07/31 15:28:31 BGP: 32.12.2.1 OPEN has Route Refresh (Old) capability (128), length 0
2019/07/31 15:28:31 BGP: 32.12.2.1 rcvd OPEN w/ optional parameter type 2 (Capability) len 2
2019/07/31 15:28:31 BGP: 32.12.2.1 OPEN has Route Refresh capability (2), length 0
2019/07/31 15:28:31 BGP: 32.12.2.1 rcvd OPEN w/ optional parameter type 2 (Capability) len 6
2019/07/31 15:28:31 BGP: message index 65 [4-octet AS number] found in capcode_str at position 4 (max is 8)
2019/07/31 15:28:31 BGP: 32.12.2.1 OPEN has 4-octet AS number capability (65), length 4
2019/07/31 15:28:31 BGP: 32.12.2.1 rcvd OPEN w/ optional parameter type 2 (Capability) len 4
2019/07/31 15:28:31 BGP: message index 64 [Graceful Restart] found in capcode_str at position 3 (max is 8)
2019/07/31 15:28:31 BGP: 32.12.2.1 OPEN has Graceful Restart capability (64), length 2
2019/07/31 15:28:31 BGP: 32.12.2.1 OPEN has Graceful Restart capability
2019/07/31 15:28:31 BGP: 32.12.2.1 Peer has restarted. Restart Time : 120
2019/07/31 15:28:31 BGP: 32.12.2.1 [FSM] Receive_OPEN_message (OpenSent->OpenConfirm)
2019/07/31 15:28:31 BGP: 32.12.2.1 send message type 4, length (incl. header) 19
2019/07/31 15:28:31 BGP: 32.12.2.1 went from OpenSent to OpenConfirm
2019/07/31 15:28:31 BGP: 32.12.2.1 rcv message type 4, length (excl. header) 0
2019/07/31 15:28:31 BGP: 32.12.2.1 [FSM] Receive_KEEPALIVE_message (OpenConfirm->Established)
2019/07/31 15:28:31 BGP: 32.12.2.1 went from OpenConfirm to Established
2019/07/31 15:28:31 BGP: %ADJCHANGE: neighbor 32.12.2.1 Up
2019/07/31 15:28:31 BGP: 32.12.2.1 send message type 4, length (incl. header) 19
2019/07/31 15:28:31 BGP: 32.12.2.1 rcv message type 4, length (excl. header) 0
2019/07/31 15:28:31 BGP: [Event] BGP connection from host 32.12.1.1:52936
2019/07/31 15:28:31 BGP: [Event] Make dummy peer structure until read Open packet
2019/07/31 15:28:31 BGP: 32.12.1.1 [FSM] TCP_connection_open (Active->OpenSent)
2019/07/31 15:28:31 BGP: 32.12.1.1 passive open
2019/07/31 15:28:31 BGP: 32.12.1.1 went from Active to OpenSent
2019/07/31 15:28:31 BGP: 32.12.1.1 rcv message type 1, length (excl. header) 40
2019/07/31 15:28:31 BGP: 32.12.1.1 rcv OPEN, version 4, remote-as (in open) 65002, holdtime 180, id 20.0.0.3, inbound connection
2019/07/31 15:28:31 BGP: 32.12.1.1:52936 [Event] Transfer accept BGP peer to real (state Active)
2019/07/31 15:28:31 BGP: 32.12.1.1 sending OPEN, version 4, my as 65001, holdtime 180, id 30.0.0.12
2019/07/31 15:28:31 BGP: 32.12.1.1 send message type 1, length (incl. header) 59
2019/07/31 15:28:31 BGP: 32.12.1.1 rcv OPEN w/ OPTION parameter len: 30
2019/07/31 15:28:31 BGP: 32.12.1.1 rcvd OPEN w/ optional parameter type 2 (Capability) len 6
2019/07/31 15:28:31 BGP: 32.12.1.1 OPEN has MultiProtocol Extensions capability (1), length 4
2019/07/31 15:28:31 BGP: 32.12.1.1 OPEN has MP_EXT CAP for afi/safi: 1/1
2019/07/31 15:28:31 BGP: 32.12.1.1 rcvd OPEN w/ optional parameter type 2 (Capability) len 2
2019/07/31 15:28:31 BGP: message index 128 [Route Refresh (Old)] found in capcode_str at position 6 (max is 8)
2019/07/31 15:28:31 BGP: 32.12.1.1 OPEN has Route Refresh (Old) capability (128), length 0
2019/07/31 15:28:31 BGP: 32.12.1.1 rcvd OPEN w/ optional parameter type 2 (Capability) len 2
2019/07/31 15:28:31 BGP: 32.12.1.1 OPEN has Route Refresh capability (2), length 0
2019/07/31 15:28:31 BGP: 32.12.1.1 rcvd OPEN w/ optional parameter type 2 (Capability) len 6
2019/07/31 15:28:31 BGP: message index 65 [4-octet AS number] found in capcode_str at position 4 (max is 8)
2019/07/31 15:28:31 BGP: 32.12.1.1 OPEN has 4-octet AS number capability (65), length 4
2019/07/31 15:28:31 BGP: 32.12.1.1 rcvd OPEN w/ optional parameter type 2 (Capability) len 4
2019/07/31 15:28:31 BGP: message index 64 [Graceful Restart] found in capcode_str at position 3 (max is 8)
2019/07/31 15:28:31 BGP: 32.12.1.1 OPEN has Graceful Restart capability (64), length 2
2019/07/31 15:28:31 BGP: 32.12.1.1 OPEN has Graceful Restart capability
2019/07/31 15:28:31 BGP: 32.12.1.1 Peer has restarted. Restart Time : 120
2019/07/31 15:28:31 BGP: 32.12.1.1 [Event] Accepting BGP peer delete
2019/07/31 15:28:31 BGP: 32.12.1.1 went from OpenSent to Deleted
2019/07/31 15:28:31 BGP: 32.12.1.1 [FSM] Receive_OPEN_message (OpenSent->OpenConfirm)
2019/07/31 15:28:31 BGP: 32.12.1.1 send message type 4, length (incl. header) 19
2019/07/31 15:28:31 BGP: 32.12.1.1 went from OpenSent to OpenConfirm
2019/07/31 15:28:31 BGP: 32.12.1.1 rcv message type 4, length (excl. header) 0
2019/07/31 15:28:31 BGP: 32.12.1.1 [FSM] Receive_KEEPALIVE_message (OpenConfirm->Established)
2019/07/31 15:28:31 BGP: 32.12.1.1 went from OpenConfirm to Established
2019/07/31 15:28:31 BGP: %ADJCHANGE: neighbor 32.12.1.1 Up
2019/07/31 15:28:31 BGP: 32.12.1.1 send message type 4, length (incl. header) 19
2019/07/31 15:28:31 BGP: 32.12.1.1 rcv message type 4, length (excl. header) 0
2019/07/31 15:28:32 BGP: 32.12.2.1 send UPDATE 32.12.1.0/31
2019/07/31 15:28:32 BGP: 32.12.2.1 send UPDATE 192.168.0.0/16
2019/07/31 15:28:32 BGP: 32.12.2.1 send UPDATE 32.12.2.0/31
2019/07/31 15:28:32 BGP: send End-of-RIB for IPv4 Unicast to 32.12.2.1
2019/07/31 15:28:32 BGP: 32.12.2.1 rcvd UPDATE w/ attr: nexthop 32.12.2.1, origin ?, metric 0, path 65002
2019/07/31 15:28:32 BGP: 32.12.2.1 rcvd 21.7.1.0/31
2019/07/31 15:28:32 BGP: 32.12.2.1 rcvd 192.168.0.0/16
2019/07/31 15:28:32 BGP: 32.12.2.1 rcvd 32.12.2.0/31
2019/07/31 15:28:32 BGP: 32.12.2.1 rcvd 32.11.2.0/31
2019/07/31 15:28:32 BGP: 32.12.2.1 rcvd 21.7.2.0/31
2019/07/31 15:28:32 BGP: 32.12.2.1 rcvd UPDATE w/ attr: nexthop 32.12.2.1, origin ?, path 65002 65006
2019/07/31 15:28:32 BGP: 32.12.2.1 rcvd 192.168.4.0/24
2019/07/31 15:28:32 BGP: 32.12.2.1 rcvd 21.8.2.0/31
2019/07/31 15:28:32 BGP: rcvd End-of-RIB for 32.12.2.1 from IPv4 Unicast
2019/07/31 15:28:32 BGP: 32.12.1.1 send UPDATE 32.12.1.0/31
2019/07/31 15:28:32 BGP: 32.12.1.1 send UPDATE 192.168.0.0/16
2019/07/31 15:28:32 BGP: 32.12.1.1 send UPDATE 32.12.2.0/31
2019/07/31 15:28:32 BGP: send End-of-RIB for IPv4 Unicast to 32.12.1.1
2019/07/31 15:28:32 BGP: 32.12.1.1 rcvd UPDATE w/ attr: nexthop 32.12.1.1, origin ?, metric 0, path 65002
2019/07/31 15:28:32 BGP: 32.12.1.1 rcvd 21.3.1.0/31
2019/07/31 15:28:32 BGP: 32.12.1.1 rcvd 192.168.0.0/16
2019/07/31 15:28:32 BGP: 32.12.1.1 rcvd 32.12.1.0/31
2019/07/31 15:28:32 BGP: 32.12.1.1 rcvd 32.11.1.0/31
2019/07/31 15:28:32 BGP: 32.12.1.1 rcvd 21.3.2.0/31
2019/07/31 15:28:32 BGP: 32.12.1.1 rcvd UPDATE w/ attr: nexthop 32.12.1.1, origin ?, path 65002 65001
2019/07/31 15:28:32 BGP: 32.12.1.1 rcvd UPDATE about 32.11.2.0/31 -- DENIED due to: as-path contains our own AS;
2019/07/31 15:28:32 BGP: rcvd End-of-RIB for 32.12.1.1 from IPv4 Unicast
2019/07/31 15:28:42 BGP: 32.12.2.1 rcvd UPDATE w/ attr: nexthop 32.12.2.1, origin ?, path 65002 65001
2019/07/31 15:28:42 BGP: 32.12.2.1 rcvd UPDATE about 32.11.1.0/31 -- DENIED due to: as-path contains our own AS;
2019/07/31 15:28:42 BGP: 32.12.2.1 rcvd UPDATE w/ attr: nexthop 32.12.2.1, origin ?, path 65002 65005
2019/07/31 15:28:42 BGP: 32.12.2.1 rcvd 192.168.3.0/24
2019/07/31 15:28:42 BGP: 32.12.2.1 rcvd 21.8.1.0/31
2019/07/31 15:28:42 BGP: 32.12.2.1 send UPDATE 21.3.2.0/31
2019/07/31 15:28:42 BGP: 32.12.2.1 send UPDATE 21.3.1.0/31
2019/07/31 15:28:42 BGP: 32.12.2.1 send UPDATE 32.11.1.0/31
2019/07/31 15:28:42 BGP: 32.12.1.1 send UPDATE 21.7.1.0/31
2019/07/31 15:28:42 BGP: 32.12.1.1 send UPDATE 21.7.2.0/31
2019/07/31 15:28:42 BGP: 32.12.1.1 send UPDATE 32.11.2.0/31
2019/07/31 15:28:42 BGP: 32.12.1.1 send UPDATE 192.168.4.0/24
2019/07/31 15:28:42 BGP: 32.12.1.1 send UPDATE 21.8.2.0/31
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd UPDATE w/ attr: nexthop 32.12.1.1, origin ?, path 65002 65003
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd 192.168.1.0/24
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd 21.4.1.0/31
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd UPDATE w/ attr: nexthop 32.12.1.1, origin ?, path 65002 65004
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd 192.168.2.0/24
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd 21.4.2.0/31
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd UPDATE w/ attr: nexthop 32.12.1.1, origin ?, path 65002 65001 65002
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd UPDATE about 21.7.1.0/31 -- DENIED due to: as-path contains our own AS;
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd UPDATE about 21.7.2.0/31 -- DENIED due to: as-path contains our own AS;
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd UPDATE w/ attr: nexthop 32.12.1.1, origin ?, path 65002 65001 65002 65006
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd UPDATE about 192.168.4.0/24 -- DENIED due to: as-path contains our own AS;
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd UPDATE about 21.8.2.0/31 -- DENIED due to: as-path contains our own AS;
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd UPDATE about 21.7.1.0/31 -- withdrawn
2019/07/31 15:28:42 BGP: 32.12.1.1 Can't find the route 21.7.1.0/31
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd UPDATE about 21.7.2.0/31 -- withdrawn
2019/07/31 15:28:42 BGP: 32.12.1.1 Can't find the route 21.7.2.0/31
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd UPDATE about 192.168.4.0/24 -- withdrawn
2019/07/31 15:28:42 BGP: 32.12.1.1 Can't find the route 192.168.4.0/24
2019/07/31 15:28:42 BGP: 32.12.1.1 rcvd UPDATE about 21.8.2.0/31 -- withdrawn
2019/07/31 15:28:42 BGP: 32.12.1.1 Can't find the route 21.8.2.0/31
2019/07/31 15:28:52 BGP: 32.12.2.1 rcvd UPDATE w/ attr: nexthop 32.12.2.1, origin ?, path 65002 65001 65002 65003
2019/07/31 15:28:52 BGP: 32.12.2.1 rcvd UPDATE about 192.168.1.0/24 -- DENIED due to: as-path contains our own AS;
2019/07/31 15:28:52 BGP: 32.12.2.1 rcvd UPDATE about 21.4.1.0/31 -- DENIED due to: as-path contains our own AS;
2019/07/31 15:28:52 BGP: 32.12.2.1 rcvd UPDATE w/ attr: nexthop 32.12.2.1, origin ?, path 65002 65001 65002 65004
2019/07/31 15:28:52 BGP: 32.12.2.1 rcvd UPDATE about 192.168.2.0/24 -- DENIED due to: as-path contains our own AS;
2019/07/31 15:28:52 BGP: 32.12.2.1 rcvd UPDATE about 21.4.2.0/31 -- DENIED due to: as-path contains our own AS;
2019/07/31 15:28:52 BGP: 32.12.2.1 send UPDATE 192.168.1.0/24
2019/07/31 15:28:52 BGP: 32.12.2.1 send UPDATE 21.4.1.0/31
2019/07/31 15:28:52 BGP: 32.12.2.1 send UPDATE 192.168.2.0/24
2019/07/31 15:28:52 BGP: 32.12.2.1 send UPDATE 21.4.2.0/31
2019/07/31 15:28:52 BGP: 32.12.2.1 rcvd UPDATE about 192.168.1.0/24 -- withdrawn
2019/07/31 15:28:52 BGP: 32.12.2.1 Can't find the route 192.168.1.0/24
2019/07/31 15:28:52 BGP: 32.12.2.1 rcvd UPDATE about 21.4.1.0/31 -- withdrawn
2019/07/31 15:28:52 BGP: 32.12.2.1 Can't find the route 21.4.1.0/31
2019/07/31 15:28:52 BGP: 32.12.2.1 rcvd UPDATE about 192.168.2.0/24 -- withdrawn
2019/07/31 15:28:52 BGP: 32.12.2.1 Can't find the route 192.168.2.0/24
2019/07/31 15:28:52 BGP: 32.12.2.1 rcvd UPDATE about 21.4.2.0/31 -- withdrawn
2019/07/31 15:28:52 BGP: 32.12.2.1 Can't find the route 21.4.2.0/31
2019/07/31 15:28:52 BGP: 32.12.1.1 send UPDATE 192.168.3.0/24
2019/07/31 15:28:52 BGP: 32.12.1.1 send UPDATE 21.8.1.0/31
2019/07/31 15:28:52 BGP: 32.12.1.1 rcvd UPDATE w/ attr: nexthop 32.12.1.1, origin ?, path 65002 65001 65002 65005
2019/07/31 15:28:52 BGP: 32.12.1.1 rcvd UPDATE about 192.168.3.0/24 -- DENIED due to: as-path contains our own AS;
2019/07/31 15:28:52 BGP: 32.12.1.1 rcvd UPDATE about 21.8.1.0/31 -- DENIED due to: as-path contains our own AS;
2019/07/31 15:28:52 BGP: 32.12.1.1 rcvd UPDATE about 192.168.3.0/24 -- withdrawn
2019/07/31 15:28:52 BGP: 32.12.1.1 Can't find the route 192.168.3.0/24
2019/07/31 15:28:52 BGP: 32.12.1.1 rcvd UPDATE about 21.8.1.0/31 -- withdrawn
2019/07/31 15:28:52 BGP: 32.12.1.1 Can't find the route 21.8.1.0/31
2019/07/31 15:29:24 BGP: 32.12.1.1 rcvd UPDATE about 21.4.1.0/31 -- withdrawn
2019/07/31 15:29:24 BGP: 32.12.1.1 rcvd UPDATE about 192.168.1.0/24 -- withdrawn
2019/07/31 15:29:24 BGP: 32.12.2.1 send UPDATE 21.4.1.0/31 -- unreachable
2019/07/31 15:29:24 BGP: 32.12.2.1 send UPDATE 192.168.1.0/24 -- unreachable
2019/07/31 15:29:24 BGP: 32.12.1.1 rcvd UPDATE about 21.3.1.0/31 -- withdrawn
2019/07/31 15:29:24 BGP: 32.12.2.1 send UPDATE 21.3.1.0/31 -- unreachable
2019/07/31 15:29:31 BGP: 32.12.2.1 rcv message type 4, length (excl. header) 0
2019/07/31 15:29:31 BGP: 32.12.2.1 [FSM] Timer (keepalive timer expire)
2019/07/31 15:29:31 BGP: 32.12.2.1 send message type 4, length (incl. header) 19
2019/07/31 15:29:31 BGP: 32.12.1.1 [FSM] Timer (keepalive timer expire)
2019/07/31 15:29:31 BGP: 32.12.1.1 send message type 4, length (incl. header) 19
2019/07/31 15:29:31 BGP: 32.12.1.1 rcv message type 4, length (excl. header) 0
